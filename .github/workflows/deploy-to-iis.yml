name: Deploy to IIS on Azure VM

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout source
      uses: actions/checkout@v3

    - name: Prepare site.zip without nesting
      run: |
        mkdir package
        cp -r * package/
        cd package
        zip -r ../site.zip .
        cd ..

    - name: Upload site.zip to Azure VM
